catching the drift : probabilistic content models , with applications to generation and summarization .
abstract .
we consider the problem of modeling the content structure of texts within a specific domain , in terms of the topics the texts address and the order in which these topics appear .
we first present an effective knowledge-lean method for learning content models from unannotated documents , utilizing a novel adaptation of algorithms for hidden markov models .
we then apply our method to two complementary tasks : information ordering and extractive summarization .
our experiments show that incorporating content models in these applications yields substantial improvement over previously-proposed methods .
introduction .
the development and application of computational models of text structure is a central concern in natural language processing .
document-level analysis of text structure is an important instance of such work .
previous research has sought to characterize texts in terms of domain-independent rhetorical elements , such as schema items ( mckeown , 1985 ) or rhetorical relations ( mann and thompson , 1988 ; marcu , 1997 ) .
the focus of our work , however , is on an equally fundamental but domain- dependent dimension of the structure of text : content .
our use of the term content corresponds roughly to the notions of topic and topic change .
we desire models that can specify , for example , that articles about earthquakes typically contain information about quake strength , location , and casualties , and that descriptions of casualties usually precede those of rescue efforts .
but rather than manually determine the topics for a given domain , we take a distributional view , learning them directly from un-annotated texts via analysis of word distribution patterns .
this idea dates back at least to harris ( 1982 ) , who claimed that various types of [ word ] recurrence patterns seem to characterize various types of discourse .
advantages of a distributional perspective include both drastic reduction in human effort and recognition of topics that might not occur to a human expert and yet , when explicitly modeled , aid in applications .
of course , the success of the distributional approach depends on the existence of recurrent patterns .
in arbitrary document collections , such patterns might be too variable to be easily detected by statistical means .
however , research has shown that texts from the same domain tend to exhibit high similarity ( wray , 2002 ) .
cognitive psychologists have long posited that this similarity is not accidental , arguing that formulaic text structure facilitates readers comprehension and recall ( bartlett , 1932 ) .
in this paper , we investigate the utility of domain- specific content models for representing topics and topic shifts .
content models are hidden markov models ( hmms ) wherein states correspond to types of information characteristic to the domain of interest ( e.g. , earthquake magnitude or previous earthquake occurrences ) , and state transitions capture possible information-presentation orderings within that domain .
we first describe an efficient , knowledge-lean method for learning both a set of topics and the relations between topics directly from un-annotated documents .
our technique incorporates a novel adaptation of the standard hmm induction algorithm that is tailored to the task of modeling content .
then , we apply techniques based on content models to two complex text-processing tasks .
first , we consider information ordering , that is , choosing a sequence in which to present a pre-selected set of items ; this is an essential step in concept-to-text generation , multi-document summarization , and other text-synthesis problems .
in our experiments , content models outperform lapata 's ( 2003 ) state-of-the-art ordering method by a wide margin for one domain and performance metric , the gap was 78 percentage points .
second , we consider extractive summarization : the compression of a document by choosing a subsequence of its sentences .
for this task , we develop a new content-model-based learning algorithm for sentence selection .
the resulting summaries yield 88 % match with human-written output , which compares favorably to the 69 % achieved by the standard leading sentences baseline .
the success of content models in these two complementary tasks demonstrates their flexibility and effectiveness , and indicates that they are sufficiently expressive to represent important text properties .
these observations , taken together with the fact that content models are conceptually intuitive and efficiently learnable from raw document collections , suggest that the formalism can prove useful in an even broader range of applications than we have considered here ; exploring the options is an appealing line of future research .
related work .
knowledge-rich methods models employing manual crafting of ( typically complex ) representations of content have generally captured one of three types of knowledge ( rambow , 1990 ; kittredge et al. , 1991 ) : domain knowledge [ e.g. , that earthquakes have magnitudes ] , domain- independent communication knowledge [ e.g. , that describing an event usually entails specifying its location ] ; and domain communication knowledge [ e.g. , that reuters earthquake reports often conclude by listing previous quakes2 ] .
formalisms exemplifying each of these knowledge types are dejong 's ( 1982 ) scripts , mckeown 's ( 1985 ) schemas , and rambow 's ( 1990 ) domain-specific schemas , respectively .
in contrast , because our models are based on a distributional view of content , they will freely incorporate information from all three categories as long as such information is manifested as a recurrent pattern .
also , in comparison to the formalisms mentioned above , content models constitute a relatively impoverished representation ; but this actually contributes to the ease with which they can be learned , and our empirical results show that they are quite effective despite their simplicity .
in recent work , duboue and mckeown ( 2003 ) propose a method for learning a content planner from a collection of texts together with a domain-specific knowledge base , but our method applies to domains in which no such knowledge base has been supplied .
knowledge-lean approaches distributional models of content have appeared with some frequency in research on text segmentation and topic-based language modeling ( hearst , 1994 ; beeferman et al. , 1997 ; chen et al. , 1998 ; florian and yarowsky , 1999 ; gildea and hofmann , 1999 ; 2this does not qualify as domain knowledge because it is not about earthquakes per se .
iyer and ostendorf , 1996 ; wu and khudanpur , 2002 ) .
in fact , the methods we employ for learning content models are quite closely related to techniques proposed in that literature ( see section 3 for more details ) .
however , language-modeling research whose goal is to predict text probabilities tends to treat topic as a useful auxiliary variable rather than a central concern ; for example , topic-based distributional information is generally interpolated with standard , non-topic-based -gram models to improve probability estimates .
our work , in contrast , treats content as a primary entity .
in particular , our induction algorithms are designed with the explicit goal of modeling document content , which is why they differ from the standard baum-welch ( or em ) algorithm for learning hidden markov models even though content models are instances of hmms .
model construction .
we employ an iterative re-estimation procedure that alternates between ( 1 ) creating clusters of text spans with similar word distributions to serve as representatives of within-document topics , and ( 2 ) computing models of word distributions and topic changes from the clusters so derived.3 formalism preliminaries we treat texts as sequences of pre-defined text spans , each presumed to convey information about a single topic .
specifying text-span length thus defines the granularity of the induced topics .
for concreteness , in what follows we will refer to ' sentences rather than text spans since that is what we used in our experiments , but paragraphs or clauses could potentially have been employed instead .
our working assumption is that all texts from a given domain are generated by a single content model .
a content model is an hmm in which each state corresponds to a distinct topic and generates sentences relevant to that topic according to a state-specific language model note that standard -gram language models can therefore be considered to be degenerate ( single-state ) content models .
state transition probabilities give the probability of changing from a given topic to another , thereby capturing constraints on topic shifts .
we can use the forward algorithm to efficiently compute the generation probability assigned to a document by a content model and the viterbi algorithm to quickly find the most likely content- model state sequence to have generated a given document ; see rabiner ( 1989 ) for details .
in our implementation , we use bigram language models , so that the probability of an -word sentence being generated by a state is < math > .
for clarity , we omit minor technical details , such as the use of dummy initial and final states .
section 5.2 describes how the free parameters , , , and are chosen .
the athens seismological institute said the temblor 's epicenter was located 380 kilometers ( 238 miles ) south of the capital .
seismologists in pakistan 's northwest frontier province said the temblor 's epicenter was about 250 kilometers ( 155 miles ) north of the provincial capital peshawar .
the temblor was centered 60 kilometers ( 35 miles ) northwest of the provincial capital of kunming , about 2,200 kilometers ( 1,300 miles ) southwest of beijing , a bureau seismologist said .
figure 1 : samples from an earthquake-articles sentence cluster , corresponding to descriptions of location .
note that the contents of the etcetera cluster are ignored at this stage .
our state-transition probability estimates arise from considering how sentences from the same article are distributed across the clusters .
more specifically , for two clusters and , let be the number of documents in which a sentence from immediately precedes one from , and let be the number of documents containing sentences from .
then , for any two states and , , we use the following smoothed estimate of the probability of transitioning from to : .
estimating the state bigram probabilities is described below .
initial topic induction as in previous work ( florian and yarowsky , 1999 ; iyer and ostendorf , 1996 ; wu and khudanpur , 2002 ) , we initialize the set of topics , distributionally construed , by partitioning all of the sentences from the documents in a given domain-specific collection into clusters .
first , we create clusters via complete-link clustering , measuring sentence similarity by the cosine metric using word bigrams as features ( figure 1 shows example output ) .4 then , given our knowledge that documents may sometimes discuss new and / or irrelevant content as well , we create an etcetera cluster by merging together all clusters containing fewer than sentences , on the assumption that such clusters consist of outlier sentences .
we use to denote the number of clusters that results .
determining states , emission probabilities , and transition probabilities given a set of clusters , where is the etcetera cluster , we construct a content model with corresponding states ; we refer to as the insertion state .
for each state , , bigram probabilities ( which induce the state 's sentence-emission probabilities ) are estimated using smoothed counts from the corresponding cluster : where is the frequency with which word sequence occurs within the sentences in cluster , and is the vocabulary .
but because we want the insertion state to model digressions or unseen topics , we take the novel step of forcing its language model to be complementary to those of the other states by setting 4following barzilay and lee ( 2003 ) , proper names , numbers and dates are ( temporarily ) replaced with generic tokens to help ensure that clusters contain sentences describing the same event type , rather than same actual event .
viterbi re-estimation our initial clustering ignores sentence order ; however , contextual clues may indicate that sentences with high lexical similarity are actually on different topics .
for instance , reuters articles about earthquakes frequently finish by mentioning previous quakes .
this means that while the sentence the temblor injured dozens at the beginning of a report is probably highly salient and should be included in a summary of it , the same sentence at the end of the piece probably refers to a different event , and so should be omitted .
a natural way to incorporate ordering information is iterative re-estimation of the model parameters , since the content model itself provides such information through its transition structure .
we take an em-like viterbi approach ( iyer and ostendorf , 1996 ) : we re-cluster the sentences by placing each one in the ( new ) cluster , , that corresponds to the state most likely to have generated it according to the viterbi decoding of the training data .
we then use this new clustering as the input to the procedure for estimating hmm parameters described above .
the cluster / estimate cycle is repeated until the clusterings stabilize or we reach a predefined number of iterations . 4 evaluation tasks we apply the techniques just described to two tasks that stand to benefit from models of content and changes in topic : information ordering for text generation and information selection for single-document summarization .
these are two complementary tasks that rely on disjoint model functionalities : the ability to order a set of pre-selected information-bearing items , and the ability to do the selection itself , extracting from an ordered sequence of information-bearing items a representative subsequence . 4.1 information ordering the information-ordering task is essential to many text- synthesis applications , including concept-to-text generation and multi-document summarization ; while accounting for the full range of discourse and stylistic factors that influence the ordering process is infeasible in many domains , probabilistic content models provide a means for handling important aspects of this problem .
we demonstrate this point by utilizing content models to select appropriate sentence orderings : we simply use a content model trained on documents from the domain of interest , selecting the ordering among all the presented candidates that the content model assigns the highest probability to . 4.2 extractive summarization content models can also be used for single-document summarization .
because ordering is not an issue in this application5 , this task tests the ability of content models to adequately represent domain topics independently of whether they do well at ordering these topics .
the usual strategy employed by domain-specific summarizers is for humans to determine a priori what types of information from the originating documents should be included ( e.g. , in stories about earthquakes , the number of victims ) ( radev and mckeown , 1998 ; white et al. , 2001 ) .
some systems avoid the need for manual analysis by learning content-selection rules from a collection of articles paired with human-authored summaries , but their learning algorithms typically focus on within- sentence features or very coarse structural features ( such as position within a paragraph ) ( kupiec et al. , 1999 ) .
our content-model-based summarization algorithm combines the advantages of both approaches ; on the one hand , it learns all required information from un-annotated document-summary pairs ; on the other hand , it operates on a more abstract and global level , making use of the topical structure of the entire document .
our algorithm is trained as follows .
given a content model acquired from the full articles using the method described in section 3 , we need to learn which topics ( represented by the content model 's states ) should appear in our summaries .
our first step is to employ the viterbi algorithm to tag all of the summary sentences and all of the sentences from the original articles with a viterbi topic label , or v-topic the name of the state most likely to have generated them .
next , for each state such that at least three full training-set articles contained v-topic , we compute the probability that the state generates sentences that should appear in a summary .
this probability is estimated by simply ( 1 ) counting the number of document-summary pairs in the parallel training data such that both the originating document and the summary contain sentences assigned v-topic , and then ( 2 ) normalizing this count by the number of full articles containing sentences with v-topic . 5typically , sentences in a single-document summary follow the order of appearance in the original document .
domain average length standard deviation vocabulary token / type size earthquakes 10.4 5.2 1182 13.2 clashes 14.0 2.6 1302 4.5 drugs 10.3 7.5 1566 4.1 finance 13.7 1.6 1378 12.8 accidents 11.5 6.3 2003 5.6 table 1 : corpus statistics .
length is in sentences .
vocabulary size and type / token ratio are computed after replacement of proper names , numbers and dates .
to produce a length- summary of a new article , the algorithm first uses the content model and viterbi decoding to assign each of the article 's sentences a v-topic .
next , the algorithm selects those states , chosen from among those that appear as the v-topic of one of the article 's sentences , that have the highest probability of generating a summary sentence , as estimated above .
sentences from the input article corresponding to these states are placed in the output summary.6 5 evaluation experiments 5.1 data for evaluation purposes , we created corpora from five domains : earthquakes , clashes between armies and rebel groups , drug-related criminal offenses , financial reports , and summaries of aviation accidents.7 specifically , the first four collections consist of ap articles from the north american news corpus gathered via a tdt-style document clustering system .
the fifth consists of narratives from the national transportation safety board 's database previously employed by jones and thompson ( 2003 ) for event-identification experiments .
for each such set , 100 articles were used for training a content model , 100 articles for testing , and 20 for the development set used for parameter tuning .
table 1 presents information about article length ( measured in sentences , as determined by the sentence separator of reynar and ratnaparkhi ( 1997 ) ) , vocabulary size , and token / type ratio for each domain . 5.2 parameter estimation our training algorithm has four free parameters : two that indirectly control the number of states in the induced content model , and two parameters for smoothing bigram probabilities .
all were tuned separately for each domain on the corresponding held-out development set using powell 's grid search ( press et al. , 1997 ) .
the parameter values were selected to optimize system performance 6if there are more than sentences , we prioritize them by the summarization probability of their v-topic 's state ; we break any further ties by order of appearance in the document .
we found that across all domains , the optimal models were based on ' sharper language models ( e.g. , ) .
the optimal number of states ranged from 32 to 95 . 5.3 ordering experiments 5.3.1 metrics the intent behind our ordering experiments is to test whether content models assign high probability to acceptable sentence arrangements .
however , one stumbling block to performing this kind of evaluation is that we do not have data on ordering quality : the set of sentences from an -sentence document can be sequenced in different ways , which even for a single text of moderate length is too many to ask humans to evaluate .
fortunately , we do know that at least the original sentence order ( oso ) in the source document must be acceptable , and so we should prefer algorithms that assign it high probability relative to the bulk of all the other possible permutations .
this observation motivates our first evaluation metric : the rank received by the oso when all permutations of a given document 's sentences are sorted by the probabilities that the model under consideration assigns to them .
the best possible rank is 0 , and the worst is .
an additional difficulty we encountered in setting up our evaluation is that while we wanted to compare our algorithms against lapata 's ( 2003 ) state-of-the-art system , her method doesnt consider all permutations ( see below ) , and so the rank metric cannot be computed for it .
to compensate , we report the oso prediction rate , which measures the percentage of test cases in which the model under consideration gives highest probability to the oso from among all possible permutations ; we expect that a good model should predict the oso a fair fraction of the time .
furthermore , to provide some assessment of the quality of the predicted orderings themselves , we follow lapata ( 2003 ) in employing kendall 's , which is a measure of how much an ordering differs from the oso the underlying assumption is that most reasonable sentence orderings should be fairly similar to it .
specifically , for a permutation of the sentences in an -sentence document , is computed as where is the number of swaps of adjacent sentences necessary to re-arrange into the oso .
the metric ranges from -1 ( inverse orders ) to 1 ( identical orders ) . 5.3.2 results for each of the 500 unseen test texts , we exhaustively enumerated all sentence permutations and ranked them using a content model from the corresponding domain .
we compared our results against those of a bigram language model ( the baseline ) and an improved version of the state-of-the-art probabilistic ordering method of lapata ( 2003 ) , both trained on the same data we used .
lapata 's method first learns a set of pairwise sentence- ordering preferences based on features such as noun-verb dependencies .
given a new set of sentences , the latest version of her method applies a viterbi-style approximation algorithm to choose a permutation satisfying many preferences ( lapata , personal communication ) .9 table 2 gives the results of our ordering-test comparison experiments .
content models outperform the alternatives almost universally , and often by a very wide margin .
we conjecture that this difference in performance stems from the ability of content models to capture global document structure .
in contrast , the other two algorithms are local , taking into account only the relationships between adjacent word pairs and adjacent sentence pairs , respectively .
it is interesting to observe that our method achieves better results despite not having access to the linguistic information incorporated by lapata 's method .
to be fair , though , her techniques were designed for a larger corpus than ours , which may aggravate data sparseness problems for such a feature-rich method .
table 3 gives further details on the rank results for our content models , showing how the rank scores were distributed ; for instance , we see that on the earthquakes domain , the oso was one of the top five permutations in 95 % of the test documents .
even in drugs and accidents the domains that proved relatively challenging to our method in more than 55 % of the cases the oso 's rank did not exceed ten .
given that the maximal possible rank in these domains exceeds three million , we believe that our model has done a good job in the ordering task .
we also computed learning curves for the different domains ; these are shown in figure 2 .
not surprisingly , performance improves with the size of the training set for all domains .
the figure also shows that the relative difficulty ( from the content-model point of view ) of the different domains remains mostly constant across varying training- set sizes .
interestingly , the two easiest domains , finance and earthquakes , can be thought of as being more formulaic or at least more redundant , in that they have the highest token / type ratios ( see table 1 ) that is , in these domains , words are repeated much more frequently on average . 8 see section 5.5 for discussion of the relation between the ordering and the summarization task . 9finding the optimal such permutation is np-complete .
domain system rank oso pred .
content 2.67 72 % 0.81 earthquakes lapata ( n / a ) 24 % 0.48 bigram 485.16 4 % 0.27 content 3.05 48 % 0.64 clashes lapata ( n / a ) 27 % 0.41 bigram 635.15 12 % 0.25 content 15.38 38 % 0.45 drugs lapata ( n / a ) 27 % 0.49 bigram 712.03 11 % 0.24 content 0.05 96 % 0.98 finance lapata ( n / a ) 18 % 0.75 bigram 7.44 66 % 0.74 content 10.96 41 % 0.44 accidents lapata ( n / a ) 10 % 0.07 bigram 973.75 2 % 0.19 table 2 : ordering results ( averages over the test cases ) .
domain rank range [ 0-4 ] [ 5-10 ] earthquakes 95 % 1 % 4 % clashes 75 % 18 % 7 % drugs 47 % 8 % 45 % finance 100 % 0 % 0 % accidents 52 % 7 % 41 % table 3 : percentage of cases for which the content model assigned to the oso a rank within a given range . 5.4 summarization experiments the evaluation of our summarization algorithm was driven by two questions : ( 1 ) are the summaries produced of acceptable quality , in terms of selected content ? and ( 2 ) does the content-model representation provide additional advantages over more locally-focused methods ?
to address the first question , we compare summaries created by our system against the lead baseline , which extracts the first sentences of the original text despite its simplicity , the results from the annual document understanding conference ( duc ) evaluation suggest that most single-document summarization systems cannot beat this baseline .
to address question ( 2 ) , we consider a summarization system that learns extraction rules directly from a parallel corpus of full texts and their summaries ( kupiec et al. , 1999 ) .
in this system , summarization is framed as a sentence-level binary classification problem : each sentence is labeled by the publicly- available boostexter system ( schapire and singer , 2000 ) as being either in or out of the summary .
the features considered for each sentence are its unigrams and figure 2 : ordering-task performance , in terms of oso prediction rate , as a function of the number of documents in the training set. its location within the text , namely beginning third , middle third and end third . 10 hence , relationships between sentences are not explicitly modeled , making this system a good basis for comparison .
we evaluated our summarization system on the earthquakes domain , since for some of the texts in this domain there is a condensed version written by ap journalists .
these summaries are mostly extractive11 ; consequently , they can be easily aligned with sentences in the original articles .
from sixty document-summary pairs , half were randomly selected to be used for training and the other half for testing . ( while thirty documents may not seem like a large number , it is comparable to the size of the training corpora used in the competitive summarization- system evaluations mentioned above . )
the average number of sentences in the full texts and summaries was 15 and 6 , respectively , for a total of 450 sentences in each of the test and ( full documents of the ) training sets .
at runtime , we provided the systems with a full document and the desired output length , namely , the length in sentences of the corresponding shortened version .
the resulting summaries were judged as a whole by the fraction of their component sentences that appeared in the human-written summary of the input text .
the results in table 4 confirm our hypothesis about the benefits of content models for text summarization our model outperforms both the sentence-level , locally- focused classifier and the lead baseline .
furthermore , as the learning curves shown in figure 3 indicate , our method achieves good performance on a small subset of parallel training data : in fact , the accuracy of our method on one third of the training data is higher than that of the 10this feature set yielded the best results among the several possibilities we tried .
clearly , this performance gain demonstrates the effectiveness of content models for the summarization task . 5.5 relation between ordering and summarization methods since we used two somewhat orthogonal tasks , ordering and summarization , to evaluate the quality of the content- model paradigm , it is interesting to ask whether the same parameterization of the model does well in both cases .
specifically , we looked at the results for different model topologies , induced by varying the number of content- model states .
for these tests , we experimented with the earthquakes data ( the only domain for which we could evaluate summarization performance ) , and exerted direct control over the number of states , rather than utilizing the cluster-size threshold ; that is , in order to create exactly states for a specific value of , we merged the smallest clusters until clusters remained .
table 5 shows the performance of the different-sized content models with respect to the summarization task and the ordering task ( using oso prediction rate ) .
while the ordering results seem to be more sensitive to the number of states , both metrics induce similar ranking on the models .
in fact , the same-size model yields top performance on both tasks .
while our experiments are limited to only one domain , the correlation in results is encouraging : optimizing parameters on one task promises to yield model size 10 20 40 60 64 80 ordering 11 % 28 % 52 % 50 % 72 % 57 % summarization 54 % 70 % 79 % 79 % 88 % 83 % table 5 : content-model performance on earthquakes as a function of model size .
ordering : oso prediction rate ; summarization : extraction accuracy. good performance on the other .
these findings provide support for the hypothesis that content models are not only helpful for specific tasks , but can serve as effective representations of text structure in general . 6 conclusions in this paper , we present an unsupervised method for the induction of content models , which capture constraints on topic selection and organization for texts in a particular domain .
incorporation of these models in ordering and summarization applications yields substantial improvement over previously-proposed methods .
these results indicate that distributional approaches widely used to model various inter-sentential phenomena can be successfully applied to capture text-level relations , empirically validating the long-standing hypothesis that word distribution patterns strongly correlate with discourse patterns within a text , at least within specific domains .
an important future direction lies in studying the correspondence between our domain-specific model and domain-independent formalisms , such as rst .
by automatically annotating a large corpus of texts with discourse relations via a rhetorical parser ( marcu , 1997 ; soricut and marcu , 2003 ) , we may be able to incorporate domain-independent relationships into the transition structure of our content models .
this study could uncover interesting connections between domain-specific stylistic constraints and generic principles of text organization .
in the literature , discourse is frequently modeled using a hierarchical structure , which suggests that probabilistic context-free grammars or hierarchical hidden markov models ( fine et al. , 1998 ) may also be applied for modeling content structure .
in the future , we plan to investigate how to bootstrap the induction of hierarchical models using labeled data derived from our content models .
we would also like to explore how domain-independent discourse constraints can be used to guide the construction of the hierarchical models .
